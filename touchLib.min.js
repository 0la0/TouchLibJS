!function(t){function i(t){if(t){if(!t.elementId)throw"cannot build object: param object needs an elementId";try{if(this.parentEl=document.getElementById(t.elementId),null==this.parentEl)throw"cannot build object: param object needs an elementId"}catch(i){console.log("err getting element")}this.canvasEl=document.createElement("canvas"),this.parentEl.appendChild(this.canvasEl),t.cssClass&&this.setClass(t.cssClass),this.g2d=this.canvasEl.getContext("2d"),this.setSize(t.width,t.height),this.g2d.clearRect(0,0,this.width,this.height),this.mouseIsDown=!1,this.renderIsInQueue=!1,this.registerListeners(this)}}function s(t){if(t){if("function"!=typeof t.notify)throw"constructor needs a notify function to be useful";if(this.notify=t.notify,t.label||(t.label=""),t.fillstyle||(t.fillstyle="#666666"),t.width||(this instanceof e?t.width=20:t.height=100),t.height||(t.height=this instanceof e?100:20),t.noOutput&&(t.outputIsOverridden=!0,this.noOutput=!0),this.outputIsOverridden=t.outputIsOverridden?t.outputIsOverridden:!1,t.label&&(this.labelEl=document.createElement("div")),i.call(this,t),t.label&&(this.labelEl.appendChild(document.createTextNode(t.label)),this.parentEl.insertBefore(this.labelEl,this.canvasEl)),t.noOutput||(this.outputEl=document.createElement("div"),this.parentEl.appendChild(this.outputEl)),this.val=0,this.lastVal=0,this.g2d=this.canvasEl.getContext("2d"),this.setSize(t.width,t.height),this.g2d.clearRect(0,0,this.width,this.height),this.g2d.fillStyle=t.fillstyle,t.sliderCss)for(var s in t.sliderCss)this.canvasEl.style[s]=t.sliderCss[s];t.cssClass&&this.setClass(t.cssClass),this.setValue(t.initVal?t.initVal:0)}}function e(t){s.call(this,t)}function h(t){s.call(this,t)}function n(t){if(!t.numBins)throw"discrete vertical slider needs an integer number of bins";this.numBins=t.numBins,this.binSize=Math.floor(t.height/this.numBins),this.lineWidth=4,this.renderHeight=this.binSize-this.lineWidth,this.currentBin=0,this.lastBin=-99,this.binBorderColor=t.binBorderColor,s.call(this,t);var i=this.g2d.fillStyle;this.g2d.fillStyle=this.binBorderColor;for(var e=0;e<=this.numBins;e++)this.g2d.fillRect(0,Math.floor(e*this.binSize),this.height,this.lineWidth);this.g2d.fillStyle=i}function o(t){if(!t.numBins)throw"discrete horizontal slider needs an integer number of bins";this.numBins=t.numBins,this.binSize=Math.floor(t.width/this.numBins),this.lineWidth=4,this.renderWidth=this.binSize-this.lineWidth,this.currentBin=0,this.lastBin=-99,this.binBorderColor=t.binBorderColor,s.call(this,t);var i=this.g2d.fillStyle;this.g2d.fillStyle=this.binBorderColor;for(var e=0;e<=this.numBins;e++)this.g2d.fillRect(Math.floor(e*this.binSize),0,this.lineWidth,this.height);this.g2d.fillStyle=i}function r(t){t&&(i.call(this,t),t.cssClass||(this.canvasEl.style.background="#ffffff",this.canvasEl.style.border="1px solid #333333"),this.g2d.clearRect(0,0,this.width,this.height),this.g2d.fillStyle=t.fillStyle,this.isMigrating=!1,this.notify=t.notify,this.cvsPos={thisX:0,thisY:0,prevX:0,prevY:0},this.normalVal={x:0,y:0},this.cvsPos.radius=void 0==t.radius?20:t.radius,this.cvsPos.radius2=2*this.cvsPos.radius,this.twoPi=2*Math.PI,this.setNormalPosition(.5,.5))}function l(t){t&&(r.call(this,t),this.crosshairStyle=t.crosshairStyle?t.crosshairStyle:"#333333")}function a(t){t&&(i.call(this,t),t.cssClass||(this.canvasEl.style.background="#ffffff",this.canvasEl.style.border="1px solid #333333"),this.radius=t.radius?t.radius:this.width/3,this.outline=t.outline?t.outline:"#cccccc",this.fillStyle=t.fillStyle?t.fillStyle:"#333333",this.realVal,this.theta=0,this.notify=t.notify,this.minAngle=.75*Math.PI,this.maxAngle=.25*Math.PI,this.range=1.5*Math.PI,this.fillstyle=t.fillstyle,this.setSize(t.width,t.height),this.render())}function u(t){if(t){i.call(this,t),this.numSliders=void 0==t.numSliders?10:t.numSliders,this.realVals=[];for(var s=0;s<this.numSliders;s++)this.realVals.push(Math.random());this.g2d.fillStyle="#666666",this.notify=t.notify,this.errMsg="slider field values need an array of length ",this.errMsg+=this.numSliders}}function c(t){u.call(this,t),this.sliderHeight=Math.floor(this.height/this.numSliders),this.render()}function d(t){u.call(this,t),this.sliderWidth=Math.floor(this.width/this.numSliders),this.g2d.translate(0,this.height),this.g2d.scale(1,-1),this.render()}function f(t){y.call(this,t),this.setVal(t.val?t.val:!1)}function p(t){if(y.call(this,t),this.timeout,this.timeoutTime,isNaN(t.triggerTimeout))throw"constructor error: need a numeric timeout parameter";this.timeoutTime=t.triggerTimeout,this.render(!1)}var g={};i.prototype={setSize:function(t,i){this.width=t,this.height=i,this.halfWidth=Math.round(t/2),this.halfHeight=Math.round(i/2),this.canvasEl.width=t,this.canvasEl.height=i,this.g2d.width=this.canvasEl.width,this.g2d.height=this.canvasEl.height},requestRender:function(){if(!this.renderIsInQueue){this.renderIsInQueue=!0;var t=this;requestAnimationFrame(function(){t.render()})}},setClass:function(t){return t?void this.canvasEl.classList.add(t):void console.log("error: no class given")},registerListeners:function(t){t.canvasEl.addEventListener("mousedown",function(i){i.preventDefault(),t.mouseIsDown=!0,t.processMouseTouch("mousedown",i.pageX-this.offsetLeft,i.pageY-this.offsetTop)},!1),t.canvasEl.addEventListener("mousemove",function(i){i.preventDefault(),t.mouseIsDown&&t.processMouseTouch("mousedown",i.pageX-this.offsetLeft,i.pageY-this.offsetTop)},!1),t.canvasEl.addEventListener("mouseout",function(i){i.preventDefault(),t.mouseIsDown=!1},!1),t.canvasEl.addEventListener("mouseup",function(i){i.preventDefault(),t.processMouseTouch("mouseup",i.pageX-this.offsetLeft,i.pageY-this.offsetTop),t.mouseIsDown=!1},!1),t.canvasEl.addEventListener("touchstart",function(i){i.preventDefault();for(var s=0;s<i.touches.length;s++)i.touches[s].target===this&&t.processMouseTouch("touchstart",i.touches[s].pageX-this.offsetLeft,i.touches[s].pageY-this.offsetTop)},!1),t.canvasEl.addEventListener("touchmove",function(i){i.preventDefault();for(var s=0;s<i.touches.length;s++)i.touches[s].target===this&&t.processMouseTouch("touchmove",i.touches[s].pageX-this.offsetLeft,i.touches[s].pageY-this.offsetTop)},!1),t.canvasEl.addEventListener("touchend",function(i){i.preventDefault(),t.processMouseTouch("touchend")},!1)},render:function(){},processMouseTouch:function(){}},s.prototype=new i,s.prototype.setClass=function(t){if(!t)throw"slider set class error: no class given";i.prototype.setClass.call(this,t),this.labelEl&&this.labelEl.classList.add(t),this.noOutput||this.outputEl.classList.add(t)},s.prototype.setValue=function(t){return 0>t||t>1?void console.log("slider set value input outOfBounds, try [0 - 1]"):void this.setVal(this instanceof e?t*this.height:t*this.width)},s.prototype.setVal=function(t){0>t&&(t=0),this.val=t,this.notify(this.getVal()),this.requestRender()},s.prototype.render=function(){this.outputIsOverridden||(this.outputEl.textContent=this.getVal())},e.prototype=new s,e.prototype.setVal=function(t){t>this.height&&(t=this.height),s.prototype.setVal.call(this,t)},e.prototype.getVal=function(){return Math.round(this.val/this.height*100)/100},e.prototype.render=function(){s.prototype.render.call(this),this.g2d.clearRect(0,this.height-this.lastVal-11,this.width,22),this.g2d.fillRect(0,this.height-this.val-10,this.width,20),this.lastVal=this.val,this.renderIsInQueue=!1},e.prototype.processMouseTouch=function(t,i,s){"touchend"!=t&&this.setVal(this.height-s)},h.prototype=new s,h.prototype.setVal=function(t){t>this.width&&(t=this.width),s.prototype.setVal.call(this,t)},h.prototype.getVal=function(){return Math.round(this.val/this.width*100)/100},h.prototype.render=function(){s.prototype.render.call(this),this.g2d.clearRect(this.lastVal-11,0,22,this.height),this.g2d.fillRect(this.val-10,0,20,this.height),this.lastVal=this.val,this.renderIsInQueue=!1},h.prototype.processMouseTouch=function(t,i){"touchend"!=t&&this.setVal(i)},n.prototype=new s,n.prototype.setVal=function(t){t>this.height&&(t=this.height);var i=t/this.height;i*=this.numBins,i=Math.floor(i),0>i?i=0:i>=this.numBins&&(i=this.numBins-1),this.currentBin=i,this.currentBin!=this.lastBin&&s.prototype.setVal.call(this,t)},n.prototype.setBin=function(t){if(0>t||t>=this.numBins)throw"indexOutOfBounds Exception";if(this.currentBin=t,this.currentBin!=this.lastBin){var i=this.currentBin*this.height;s.prototype.setVal.call(this,i)}},n.prototype.getVal=function(){return this.currentBin},n.prototype.render=function(){s.prototype.render.call(this),this.g2d.clearRect(0,Math.floor(this.lastBin*this.binSize)+this.lineWidth,this.width,this.renderHeight),this.g2d.fillRect(0,Math.floor(this.currentBin*this.binSize)+this.lineWidth,this.width,this.renderHeight),this.lastBin=this.currentBin,this.renderIsInQueue=!1},n.prototype.processMouseTouch=function(t,i,s){"touchend"!=t&&this.setVal(s)},o.prototype=new s,o.prototype.setVal=function(t){t>this.width&&(t=this.width);var i=t/this.width;i*=this.numBins,i=Math.floor(i),0>i?i=0:i>=this.numBins&&(i=this.numBins-1),this.currentBin=i,this.currentBin!=this.lastBin&&s.prototype.setVal.call(this,t)},o.prototype.setBin=function(t){if(0>t||t>=this.numBins)throw"indexOutOfBounds Exception";if(this.currentBin=t,this.currentBin!=this.lastBin){var i=this.currentBin*this.width;s.prototype.setVal.call(this,i)}},o.prototype.getVal=function(){return this.currentBin},o.prototype.render=function(){s.prototype.render.call(this),this.g2d.clearRect(Math.floor(this.lastBin*this.binSize)+this.lineWidth,0,this.renderWidth,this.height),this.g2d.fillRect(Math.floor(this.currentBin*this.binSize)+this.lineWidth,0,this.renderWidth,this.height),this.lastBin=this.currentBin,this.renderIsInQueue=!1},o.prototype.processMouseTouch=function(t,i){"touchend"!=t&&this.setVal(i)},r.prototype=new i,r.prototype.processMouseTouch=function(t,i,s){"touchend"!=t&&(0>i?i=0:i>=this.width&&(i=this.width-1),0>s?s=0:s>=this.height&&(s=this.height-1),this.cvsPos.thisX=i,this.cvsPos.thisY=s,this.setRealPosition(i,s),this.requestRender())},r.prototype.render=function(){this.g2d.clearRect(this.cvsPos.prevX-this.cvsPos.radius-1,this.cvsPos.prevY-this.cvsPos.radius-1,this.cvsPos.radius2+2,this.cvsPos.radius2+2),this.g2d.beginPath(),this.g2d.arc(this.cvsPos.thisX,this.cvsPos.thisY,this.cvsPos.radius,0,this.twoPi),this.g2d.closePath(),this.g2d.fill(),this.cvsPos.prevX=this.cvsPos.thisX,this.cvsPos.prevY=this.cvsPos.thisY,this instanceof l||(this.renderIsInQueue=!1)},r.prototype.setRealPosition=function(t,i){this.normalVal.x=t/this.width,this.normalVal.y=(this.height-i)/this.height,this instanceof l||this.notify({x:this.normalVal.x,y:this.normalVal.y})},r.prototype.setNormalPosition=function(t,i){this.processMouseTouch("",t*this.width,this.height-i*this.height)},r.prototype.getRealVal=function(){return{x:this.cvsPos.thisX,y:this.cvsPos.thisY}},r.prototype.getNormalVal=function(){return this.normalVal},l.prototype=new r,l.prototype.setRealPosition=function(t,i){r.prototype.setRealPosition.call(this,t,i),this.notify({x:this.normalVal.x-.5,y:this.normalVal.y-.5})},l.prototype.processMouseTouch=function(t,i,s){"mouseout"==t||"mouseup"==t||"touchend"==t?(this.isMigrating=!0,this.migrate()):r.prototype.processMouseTouch.call(this,t,i,s)},l.prototype.render=function(){r.prototype.render.call(this);var t=this.g2d.fillStyle;this.g2d.fillStyle=this.crosshairStyle,this.g2d.beginPath(),this.g2d.moveTo(this.halfWidth,0),this.g2d.lineTo(this.halfWidth,this.height),this.g2d.moveTo(0,this.halfHeight),this.g2d.lineTo(this.width,this.halfHeight),this.g2d.stroke(),this.g2d.fillStyle=t,this.renderIsInQueue=!1},l.prototype.migrate=function(){var t=.3,i=0-(this.normalVal.x-.5),s=0-(this.normalVal.y-.5),e=Math.sqrt(i*i+s*s);if(e>.05){var h=this.normalVal.x+t*i,n=this.normalVal.y+t*s;this.setNormalPosition(h,n);var o=this;requestAnimationFrame(function(){o.migrate()})}else this.setNormalPosition(.5,.5),this.isMigrating=!1},a.prototype=new i,a.prototype.render=function(){this.g2d.strokeStyle=this.outline,this.g2d.lineWidth=this.radius,this.g2d.beginPath(),this.g2d.arc(this.halfWidth,this.halfHeight,this.radius,this.minAngle,this.maxAngle),this.g2d.stroke(),this.g2d.strokeStyle=this.fillStyle,this.g2d.lineWidth=this.radius-10,this.g2d.beginPath(),this.g2d.arc(this.halfWidth,this.halfHeight,this.radius,this.minAngle,this.theta),this.g2d.stroke(),this.renderIsInQueue=!1},a.prototype.processMouseTouch=function(t,i,s){if("touchend"!=t){i-=this.halfWidth,s-=this.halfHeight;var e,h=Math.atan(s/i);0>i?(h+=Math.PI,e=h-this.minAngle):0>s?(h+=2*Math.PI,e=h-this.minAngle):e=h-this.minAngle+2*Math.PI,h>this.maxAngle&&h<this.minAngle||(e/=this.range,this.realVal=e,this.notify(e),this.theta=h,this.requestRender())}},a.prototype.getVal=function(){return this.realVal},a.prototype.setVal=function(t){if(0>t||t>1)throw"valueOutOfBounds Exception, takes [0 - 1]";this.realVal=t;var i=t*this.range;this.theta=i+this.minAngle,this.notify(t),this.requestRender()},u.prototype=new i,u.prototype.setVal=function(t,i){if(0>t||t>=this.numSliders)throw"SliderField.setVal - indexOutOfBounds Exception";0>i?i=0:i>1&&(i=1),this.realVals[t]=i,this.notify(this.realVals),this.requestRender()},u.prototype.setVals=function(t){if(!(t instanceof Array))throw this.errMsg;if(t.length!=this.numSliders)throw this.errMsg;for(var i=0;i<this.numSliders;i++){var s=t[i];0>s?s=0:s>1&&(s=1),this.realVals[i]=s}this.notify(this.realVals),this.requestRender()},u.prototype.getVal=function(t){if(0>t||t>=this.numSliders)throw"SliderField.setVal - indexOutOfBounds Exception";return this.realVals[t]},u.prototype.getVal=function(){return this.realVals},c.prototype=new u,c.prototype.processMouseTouch=function(t,i,s){if("touchend"!=t){for(var e,h=0;h<this.numSliders;h++){var n=h*this.sliderHeight,o=n+this.sliderHeight;if(s>=n&&o>=s){e=h;break}}void 0!=e&&this.setVal(e,i/this.width)}},c.prototype.render=function(){this.g2d.clearRect(0,0,this.width,this.height);for(var t=0;t<this.numSliders;t++)this.g2d.fillRect(0,t*this.sliderHeight+2,this.realVals[t]*this.width,this.sliderHeight-2);this.renderIsInQueue=!1},d.prototype=new u,d.prototype.processMouseTouch=function(t,i,s){if("touchend"!=t){for(var e,h=0;h<this.numSliders;h++){var n=h*this.sliderWidth,o=n+this.sliderWidth;if(i>=n&&o>=i){e=h;break}}void 0!=e&&this.setVal(e,(this.height-s)/this.height)}},d.prototype.render=function(){this.g2d.clearRect(0,0,this.width,this.height);for(var t=0;t<this.numSliders;t++)this.g2d.fillRect(t*this.sliderWidth+2,0,this.sliderWidth-2,this.realVals[t]*this.height);this.renderIsInQueue=!1};var y=function(t){if(t){if(this.val,this.notify,this.element,this.on,this.off,!t.elementId)throw"cannot build button: param object needs an elementId";try{if(this.element=document.getElementById(t.elementId),null==this.element)throw"cannot build button: param object needs an elementId"}catch(i){console.log("err getting element")}if("function"!=typeof t.notify)throw"button constructor needs an notify function to be useful";if(this.notify=t.notify,!t.on)throw"pram object needs on attributes";if(this.on=t.on,!t.off)throw"pram object needs off attributes";if(this.off=t.off,t.cssClassName&&this.setClass(t.cssClassName),t.css)for(var s in t.css)this.element.style[s]=t.css[s];this.createListeners(this)}};y.prototype={createListeners:function(t){try{t.element.addEventListener("mousedown",function(i){i.preventDefault(),t.processAction()},!1)}catch(i){console.log("error creating mouse listener")}try{t.element.addEventListener("touchstart",function(i){i.preventDefault(),t.processAction()},!1)}catch(i){console.log("error creating touch listener")}},render:function(t){if(t)for(var i in this.on)"textContent"==i?this.element[i]=this.on[i]:this.element.style[i]=this.on[i];else for(var i in this.off)"textContent"==i?this.element[i]=this.off[i]:this.element.style[i]=this.off[i]},setClass:function(t){return null==t?void console.log("error: no class given"):void this.element.classList.add(t)},processAction:function(){}},f.prototype=new y,f.prototype.processAction=function(){this.val=!this.val,this.notify(this.val),this.render(this.val)},f.prototype.setVal=function(t){this.val=t,this.notify(this.val),this.render(this.val)},f.prototype.getVal=function(){return this.val},p.prototype=new y,p.prototype.processAction=function(){this.notify(),this.render(!0),clearTimeout(this.timeout);var t=this;this.timeout=setTimeout(function(){t.render(!1)},t.timeoutTime)},g.VertSlider=e,g.HorizSlider=h,g.DiscreteVertSlider=n,g.DiscreteHorizSlider=o,g.ToggleButton=f,g.TriggerButton=p,g.Slider2D=r,g.Joystick=l,g.Knob=a,g.SliderFieldHoriz=c,g.SliderFieldVert=d,t.TouchLib=g}(window);